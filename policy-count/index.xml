<?xml version="1.0" encoding="UTF-8" ?>
<Module>
    <ModulePrefs title="Sample Number Chart"
                 author="WSO2 Gadget Server"
                 height="100"
                 scrolling="false"
                 tags="charts,number,visualization,data"
                 description="Testable Number Chart Sample">
    </ModulePrefs>
    <Content type="html">
        <![CDATA[
             <html>
               <head>
                  <title>Number Chart</title>
                  <!-- <link href="css/igviz.css" rel="stylesheet" type="text/css"> -->
                  <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css">
                  <!-- <link href="css/d3.geomap.css" rel="stylesheet" type="text/css"> -->

                  <script language="javascript" type="text/javascript" src="js/excanvas.min.js"></script>
                  <script language="javascript" type="text/javascript" src="js/jquery.js"></script>
                  <!-- <script language="javascript" type="text/javascript" src="js/topojson.js"></script> -->
                  <script language="javascript" type="text/javascript" src="js/d3.min.js"></script>
                  <script language="javascript" type="text/javascript" src="js/vega.js"></script>
                  <script language="javascript" type="text/javascript" src="js/VizGrammar.min.js"></script>
                  <!-- <script language="javascript" type="text/javascript" src="js/gadgetconf.js"></script> -->
                  <!-- <script language="javascript" type="text/javascript" src="js/outputAdapterUiLibrary.js"></script> -->
                  <!-- <script language="javascript" type="text/javascript" src="js/main.js"></script> -->

                  <script language="javascript" type="text/javascript">

                    var data = [
                      {
                        "metadata": {
                            "names" : ["policy-count"],
                            "types" : ["linear"]
                          },
                        "data": [
                            ["loading ..."]
                          ]
                      }
                    ];

                    var config = {
                      title : "",
                      charts : [{x : "policy-count", type: "number"}]
                    }

                    $(document).ready(function(){
                      var numberChart = new vizg(data, config);
                      numberChart.draw("#placeholder");

                      var api = "/portal/custom/policy-count";

                      setInterval(function () {
                          $.get(api, function(data) {
                            data = JSON.parse(data);
                            if (data.status == 200) {
                              numberChart.insert([[data.data]]);
                            }
                          });
                      }, 1000);
                    });

                    /*if(jQuery("#placeholder").html() == ""){
                      jQuery("#placeholder").append('<div id="noChart"><table><tr><td style="padding:30px 20px 0px 20px"></td><td><br/><b><p><br/> Data is not available for populating in the chart.</p></b></td></tr><tr><td></td><td><p>The chart will be loaded once the dashboard receives events</p><td/></tr></table></div>');
                    }*/
                  </script>
              </head>
              <body style="margin-bottom: 0px;">
                  <div style="height: 10px;"></div>
                  <div id="placeholder"></div>
              </body>
            </html>
        ]]>
    </Content>
</Module>


